<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>My Profile</title>
<link href="https://vula.uct.ac.za/library/skin/tool_base.css" type="text/css" rel="stylesheet" media="all" rsf:id="scr=portal-matter" />
<link href="https://vula.uct.ac.za/library/skin/tool.css" type="text/css" rel="stylesheet" media="all"  rsf:id="scr=portal-matter"/>
<script type="text/javascript" language="JavaScript"
	src="file:///C|/Documents%20and%20Settings/administrator/Desktop/edit_files/headscripts.js" rsf:id="scr=portal-matter"></script>
	<script>
	$(document).ready(function(){
		var options = {
			beforeSend: function(){
				$('.success').each(function(){
					$(this).slideUp('fast');
				});
			},
   		 success: function(msg) {
			 $(document).trigger('close.facebox');			 
			 $('.portletBody').eq(0).prepend('<span class="success">' + $(msg).find('.success').html() + '<a href="#"><div name="closeMsg">close</div></a></span>');
			 //$('.profileImage img').attr('src', $(msg).find('.profileImage img').attr('src'));
			$('.success div').bind('click', function(){
				$(this).parent().parent().slideUp('normal');
			});
    	  }
 	 };
		$.facebox.setHeader($('.noExist'));
		$.facebox.setHeader($('.titleHeader'));

		$('.selectImage').bind('click', function(){
			that = $(this);
			$('.profileImage img').attr('src', $(this).find('img').attr('src'));
			//that.attr('class', that.attr('class') + ' imageSelected');
			$('.album').find('input[@type*=radio]').each(function(){
				$(this).removeAttr('checked');
			});
			that.parent().find('input[@type*=radio]').attr('checked', 'checked');
			$('#form').ajaxSubmit(options);
			return false;
		});		
		
		$('.officialPic').bind('click', function(){
			$.get('officialpic','',
				function(f){
					var form = $(f).find('form');
					if (form) {
						form.ajaxSubmit({
							success: function(msg){
								$(document).trigger('close.facebox');
								$('.portletBody').prepend('<span class="success">' + $(msg).find('.success').html() + '<a href="#"><div name="closeMsg">close</div></a></span>');
								$('.profileImage img').attr('src', $(msg).find('.profileImage img').attr('src'));
								//$('.success div').bind('click', function(){
								//	$(this).parent().parent().slideUp('normal');
								}
						});
					}
					else 
					{alert('No form');}
					/*$.post(
						'officialpic',
						params,
						function(msg){
							 $(document).trigger('close.facebox');			 
							 $('.portletBody').prepend('<span class="success">' + $(msg).find('.success').html() + '<a href="#"><div name="closeMsg">close</div></a></span>');
							 $('.profileImage img').attr('src', $(msg).find('.profileImage img').attr('src'));
							 $('.success div').bind('click', function(){
								$(this).parent().parent().slideUp('normal');
							});	*/			
						return false;
						}
					//}
				);
			return false;
		});

		$('.removePicture').bind('click', function(){
			$('input[@type*=radio]').each(function(){
				$(this).removeAttr('checked');
			});
			$('#form').ajaxSubmit(options);
			return false;
		});


		$('.selectOfficialImage').bind('click', function(){
			$('.profileImage img').attr('src', $(this).find('img').attr('src'));
			var opts = {
				success: function(msg){
					$(document).trigger('close.facebox');
					//$('.profileImage img').attr('src', $(msg).find('.activeSelectedImage').attr('src'));
				}
			};
			$('.officialPicForm').ajaxSubmit(opts);
			return false;
		});

		
	});
		
	function formSubmit(that){
		if ($('input[@name*=fileupload1]').val()) {
			$('#uploadPicture').attr('class', 'loading');
			$(that).unbind('click');
			$(that).bind('click', function(){return false});
			return true;
			}
		else {					
		return false;
		}
	}	
	
</script>
</head>
<body rsf:id="scr=sakai-body">
<div class="portletBody"> 

<h3 style="font-weight: bold;" class="titleHeader">Change profile picture</h3>

<div rsf:id="message-for:*" class="alertMessage">
	<span>Message for user here</span>
</div>
	
<form rsf:id="upload-pic-form" id="" class="uploadPictureForm" method="post" enctype="multipart/form-data">
<span class="addItem">Upload a picture </span>
<input type="file" name="fileupload1"/>
<input rsf:id="submit" id="submit" type="submit" class="active" onclick="return formSubmit(this);" value="Upload"/>
<!-- <input id="submit" type="button" value="Cancel"/> -->
</form>
	<div>or select one of the following pictures:</div>
	<br />
	<!--
<table cellpadding="5" align="left">
<tr><td>	
<form method="post" rsf:id="form" id="form">
<td class="activeImage" align="center">
 <span rsf:id="current-pic-title">My UCT picture</span>
 <img rsf:id="selected-image" class="activeSelectedImage" src="../images/active-picture.jpg"  width="75px"/>
</td>  
<td rsf:id="official-pic:" id="officialPic" class="selectOfficialImage" align="center" width="25%">	
	<a href="#"><span rsf:id="official-pic-title">My UCT picture</span></a>
	<a href="#"><img src="officialPic.gif" alt="Use your official UCT photo" border="none" rsf:id="official-pic-image" /></a>
	<form rsf:id="official-pic-form" class="officialPicForm">
	<input  type="hidden" name="select" rsf:id="official-pic-field" />
	</form>
 </td>	
<table cellpadding="5" align="left">-->
<!-- This span is needed here to guide the renderer away to the checkboxes -->
<!--
<span rsf:id="select-pic"/>
	<tr rsf:id="pic-row:">
	
	<td rsf:id="pic-cell:" align="center" class="selectImage">
		<input rsf:id="select" type="radio" name="choose" style="display:none;" />
	<a href="#"><img rsf:id="pic" src="../images/pictureUnavailable.jpg" width="75px" /></a></td>
	</tr>
	</table>
<input type="hidden" rsf:id="submit" value="Change picture" />    
</form>	
	
	</td></tr>
</table>   -->
<form method="post" rsf:id="form" id="form">
<span rsf:id="select-pic"/>
	  <div class="album">	
		 <div class="imageSingle" rsf:id="selected-image:">
		   <div class="image activeSelectedImage"><img rsf:id="selected-image" src="../images/pictureUnavailable.jpg" width="75px" /></div>
		</div>
		
		<div class="imageSingle" rsf:id="no-image:">
		   <div class="image removePicture"><a href="#"><img rsf:id="no-image" src="../images/pictureUnavailable.jpg" width="75px" /></a></div>
		</div>
		
		 <div class="imageSingle" rsf:id="official-pic:">
		   <div class="image selectOfficialImage"><a href="#"><img rsf:id="official-pic-image" src="../images/pictureUnavailable.jpg" width="75px" /></a></div>
		</div>

	    <div class="imageSingle" rsf:id="pic-cell:">
	    	<input rsf:id="select" type="radio" name="choose" style="display:none;" />
		   <div class="image selectImage"><a href="#"><img rsf:id="pic" src="../images/pictureUnavailable.jpg" width="75px" /></a></div>
		</div>
	  </div>
	  <input type="hidden" rsf:id="submit" value="Change picture" />    
</form>
<div style="display:none;" rsf:id="official-pic-form:">
<form rsf:id="official-pic-form" class="officialPicForm">
				<input  type="hidden" name="select" rsf:id="official-pic-field" />
			</form>
			</div>
</div>
</body> 
</html>
